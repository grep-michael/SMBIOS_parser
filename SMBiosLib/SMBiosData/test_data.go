package smbiosdata

import (
	"encoding/base64"
	"log"
	"os"
)

var mac1SMBIOS = SMBiosData{
	DMI_TABLE_b64S: `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`,
	EPS_b64S:       `X1NNXzkfAwNDAQAAAAAAAF9ETUlfezYKAPDzcyQAMw==`,
}
var mac3SMBIOS = SMBiosData{
	DMI_TABLE_b64S: `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`,
	EPS_b64S:       `X1NNX0QfAwA7AQAAAAAAAF9ETUlfpPwJAPDviiYAMA==`,
}

var localSMBIOS = loadLocalSMBIOS()

func loadLocalSMBIOS() (data SMBiosData) {
	var err error
	data.DMI_TABLE_b64S, err = read("/sys/firmware/dmi/tables/DMI")
	if err != nil {
		log.Printf("Error Loading local DMI table: %+v\n", err)
		return data
	}
	data.EPS_b64S, err = read("/sys/firmware/dmi/tables/smbios_entry_point")
	if err != nil {
		log.Printf("Error Loading local EPS_b64S: %+v\n", err)
	}
	return data
}
func read(file_path string) (string, error) {
	fileData, err := os.ReadFile(file_path)
	if err != nil {
		return "", err
	}
	encoded := base64.StdEncoding.EncodeToString(fileData)
	return encoded, nil
}

var testData = []SMBiosData{mac1SMBIOS, mac3SMBIOS, localSMBIOS}

func GetTestData(index int) SMBiosData {
	if index < 0 || index > len(testData) {
		log.Println("Test index out of range")
		return SMBiosData{}
	}
	return testData[index]
}
